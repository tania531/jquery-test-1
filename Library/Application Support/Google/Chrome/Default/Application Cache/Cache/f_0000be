function Erc(a,b,c,d){var e=null;a.j.every(function(a,h,l){if(b&&(h>c||h==c&&l>=d))return!1;a.isEmpty()||(e=new F(l,h));return!0});return e}function Frc(a,b,c){var d=null;a.j.some(function(a,f,h){return(f>b||f==b&&h>c)&&!a.isEmpty()?(d=new F(h,f),!0):!1});return d}gL.prototype.yqa=Z(277,function(a,b,c,d){for(var e=a-1,f=this.Zd.length;0<=e;){var h=this.Zd[e--];if(!(h.getSheetType()!=b||h.o&&d))return h}if(!c)return null;for(e=f-1;e>=a;)if(c=this.Zd[e--],!(c.getSheetType()!=b||c.o&&d))return c;return null});
function Grc(a,b,c){var d=0,e=-1;b&&(d=b.y,e=b.x);var f=null;return f=c?Erc(a,!!b,d,e):Frc(a,d,e)}function Hrc(a,b){if(!b)return null;var c=null;a.j.some(function(a,e,f){a=a.vc();for(var h=0;h<a.length;h++)if(a[h]==b)return c=new F(f,e),!0;return!1});return c}function Irc(a){var b=new ed;a.j.forEach(function(a){a.isEmpty()||fd(b,a.vc())});return b.vc()}function Jrc(a,b){var c=a.j.Jd(b.y,b.x);return c?c.vc():[]}
function Krc(a,b){var c=fs(a.k);Qb(a.M,function(a,e){var f=this.C.jo(a);Number(e)==c&&b?im(f,"docs-icon-comment-blank-highlighted"):km(f,"docs-icon-comment-blank-highlighted")},a)}function H7(a){return a.j.hasUnpostedDocos()}function Lrc(a,b){for(var c=[],d=0;d<b.length;d++)c.push(a.k.j[b[d]]||0);a.j.deleteDocoPositions(c)}function Mrc(a,b){var c={},d;for(d in b){var e=a.k.j[d]||0;e&&a.j.hasDoco(e)&&(c[e]=b[d])}return c}function Nrc(a){return a.k}
function I7(a,b,c){Tn.call(this,10100,b);this.wb=a;this.j=b;this.k=c}B(I7,Tn);I7.prototype.Ki=Bc;I7.prototype.ld=q(35);I7.prototype.cd=function(){var a=new ur,b=Zn(this.k,this.j);J(a,1,this.wb);J(a,2,b);return a};I7.prototype.Li=Bc;function Orc(a){this.j={};if(a)for(var b in a)this.set(b,a[b])}Orc.prototype.get=function(a){if(!(a in this.j))throw Error("No value for key "+a);return this.j[a]};Orc.prototype.set=function(a,b){this.j[a]=b};function Prc(a){this.j=new Orc;this.o=a||null}Prc.prototype.k=function(a){try{var b=Jd(a)}catch(c){return this.o&&this.o.log(Error("Invalid serialized anchor ID")),null}return this.j.get(b.type).j(b)};Prc.prototype.Vb=function(a){return Ld(this.j.get(a.getType()).Vb(a))};function J7(a,b){this.o=a;this.k=b}J7.prototype.getType=g("o");function Qrc(a){J7.call(this,"range",0);this.q=a}B(Qrc,J7);Qrc.prototype.j=g("q");function Rrc(){}ja(Rrc);Rrc.prototype.j=function(a){return new Qrc(a.range)};Rrc.prototype.Vb=function(a){var b={};b.type=a.getType();b.uid=a.k;b.range=a.j();return b};function K7(a,b){J7.call(this,"workbook-range",0);this.B=a;this.q=!!b}B(K7,J7);K7.prototype.j=g("B");function Src(){}ja(Src);Src.prototype.j=function(a){return new K7(a.range)};Src.prototype.Vb=function(a){var b={};b.type=a.q?"range":"workbook-range";b.uid=a.k;b.range=a.j();return b};function L7(){Prc.call(this);var a=Rrc.getInstance();this.j.set("range",a);a=Src.getInstance();this.j.set("workbook-range",a)}B(L7,Prc);ja(L7);L7.prototype.k=function(a){return(a=L7.H.k.call(this,a))?("range"==a.getType()&&(a=new K7(a.j(),!0)),a):null};function M7(a,b){if(!b)return null;var c=b.j();return"range"==b.getType()?(c=a.j[c],Trc(c)?c.sb().xd():null):(c=Urc(b))&&Vrc(Wrc(c))?Wrc(c).xd():null}function Urc(a){var b=new Sn,c;try{c=ritz.getWorkbookRangeById(a.j(),!0)}catch(d){}return c?b.jd((new ki).U(),ritz.getWorkbookRangeById(a.j(),!0)):null}function Wrc(a){return new kf(a.mb(),a.kb(),a.Ib(),a.Pb())}
function N7(a,b,c){return c?"range"==c.getType()?(b=b.j[c.j()],Trc(b)?(b=b.jb(),null!=b?Xrc(a,b):null):null):(b=Urc(c))&&Vrc(Wrc(b))?Xrc(a,parseInt(b.bb(),10)):null:null}function Xrc(a,b){var c=lu(a,b);return c?c.Gb():null}function Trc(a){return!!a&&a.j&&Vrc(a.sb())}function Vrc(a){return!!a&&qea(a)&&zf(a)};function Yrc(a,b,c,d,e,f,h,l,m,n,p){K.call(this);this.q=a;this.Ea=b;this.Z=c;this.Wa=d;this.D=e;this.Ra=f;this.j=h;this.ba=l;this.k=m;this.P=n;this.C=b.Z;this.o=b.j;this.B=b.B;this.G=L7.getInstance();this.M={};this.K=new ed;this.V=new ns(0);a=[this.V];Eb(p.k,a);h4a(p,a);p.j=f4a(p.k);g4a(p);this.J=new R(this);Zrc(this)}B(Yrc,K);t=Yrc.prototype;t.Ifa=!1;
function Zrc(a){var b=lb(Aya,function(a){return!Dya[a]});a.J.F(a.Wa,"activity-box-closed",a.o3a).F(a.D,"mouseover",O7(a,a.f$a)).F(a.D,"click",O7(a,a.d$a)).F(a.D,"selectionChange",O7(a,a.g$a)).F(a.D,"inputBoxActivate",O7(a,a.b$a)).F(a.D,"hide_docos",O7(a,a.e$a)).F(a.o,"b",O7(a,a.qrb)).F(a.j,"view-comments",a.L7a).F(a.j,"comment-indicator-hover-start",a.J7a).F(a.j,"comment-indicator-hover-end",a.I7a).F(a.D,"insert_doco",a.nrb).F(new Rt(a.ba),"mousewheel",a.orb).F(a.B,["add_named_range","delete_named_range"],
a.X3a).F(a.Ea,"docos_change",a.n$a).F(a.P,"pe",a.qWa).F(a.o,"a",a.nua);var c=ru(a.o);a.J.F(c,b,a.c$a);a.J.F(c,["Fa"],O7(a,a.prb));sF(a.q,Docos.EventType.HOVER,O7(a,a.BZa));sF(a.q,Docos.EventType.SELECTED,O7(a,a.mrb));sF(a.q,Docos.EventType.CREATED,a.Xsa,a);sF(a.q,Docos.EventType.UNRESOLVED,a.Xsa,a);sF(a.q,Docos.EventType.DELETED,a.Ysa,a);sF(a.q,Docos.EventType.RESOLVED,a.Ysa,a);sF(a.q,Docos.EventType.POSTED,a.ZZa,a);sF(a.q,Docos.EventType.PENDING,a.Z4a,a);V.Zs.gc(jq,A(a.H1a,a));T.Yu.gc(jq,A(a.iWa,
a));T.yT.subscribe("action",A(a.J3a,a));T.zT.subscribe("action",A(a.S3a,a));T.AT.subscribe("action",A(a.T3a,a));a.nua()}t.nua=function(){var a=zG(this.o);T.yT.ga(a);T.zT.ga(a);T.AT.ga(a)};t.H1a=function(){this.q.setOption(Docos.OptionName.READONLY,!this.Ea.lr())};function O7(a,b){return A(function(a){this.Ifa||b.call(this,a)},a)}
t.nrb=function(){var a=TA(this.o),b=jv(a);if(b&&!H7(this.q)&&!$rc(this,a,b)){var c=ritz.getNewWorkbookRangeId();this.Ra.Mb(new I7(c,a.jb(),mf(b)));a=this.G.Vb(new K7(c));if(a=P7(this,a))this.k.dispatchEvent(new Q7("xe",[a],b)),this.Z.j(2)}};function $rc(a,b,c){c=Jrc(PA(a.C,b),c);return c.length?(b=a.q,a=a.G.Vb(c[0]),b.j.highlightDoco(b.k.j[a]||0,!0),!0):!1}t.Xsa=function(a){E(a.j,function(a){R7(this,!0,a);this.K.add(a)},this)};t.Ysa=function(a){E(a.j,function(a){R7(this,!1,a);this.K.remove(a)},this)};
function R7(a,b,c,d,e){c=P7(a,c);d=d||N7(a.o,a.B,c);e=e||M7(a.B,c);if(c&&d&&e){var f=PA(a.C,d);if(b){var h=f.j.Jd(e.y,e.x)||new ed;h.add(c);tu(f.j,e.y,e.x,h)}else(h=f.j.Jd(e.y,e.x))&&h.remove(c);f.k.dispatchEvent(Os(mf(e)));a.o.getActiveGrid()&&(d=d==TA(a.o),b?(a=a.k,(b=d?e:null)&&$e(b,a.wJ)&&a.j.add(c),a.dispatchEvent(new Q7("qe",[c],b))):(a=a.k,(b=d?e:null)&&$e(b,a.wJ)&&a.j.remove(c),a.Cs==c&&(a.Cs=null),a.dispatchEvent(new Q7("ze",[c],b))))}else a.k.dispatchEvent("Be")}
function P7(a,b){if(!b)return null;if(!a.M[b]){var c=a.G.k(b);c&&(a.M[b]=c)}return a.M[b]}t.qrb=function(){this.k.reset()};t.BZa=function(a){a=P7(this,a.j.length?a.j[0]:null);var b=M7(this.B,a);this.k.dispatchEvent(new Q7("ue",[a],b))};t.ZZa=ba();t.Z4a=function(){var a=this.V,b=this.q.j.hasPendingContent();os(a,ms(a.va,4,b))};t.o3a=function(){this.Z.j(3)};
t.mrb=function(a){if(!H7(this.q)){var b=P7(this,a.j.length?a.j[0]:null),c=M7(this.B,b);b&&c?(this.Ifa=!0,asc(this.k,b,c)):b||a.q?this.k.reset():b||this.Z.j(3)}};t.qWa=function(){this.Ifa=!1};t.e$a=function(){this.k.dispatchEvent("we")};t.g$a=function(){if(!this.P.isEmpty()&&!H7(this.q)){this.Z.j(3);var a=this.k,b=jv(TA(this.o));$e(a.TK,b)||!a.Cs&&!a.fl&&$e(a.wJ,b)||(S7(a),a.dispatchEvent(new Q7("te",[],b)))}};
t.d$a=function(){var a=TA(this.o);if(!H7(this.q)&&a){var b=PA(this.C,a),c=(a=jv(a))?Jrc(b,a):[];c.length&&(b=this.k,c=c[0],$e(b.TK,a)?(S7(b),b.dispatchEvent(new Q7("re",[],a))):b.dispatchEvent(new Q7("re",[c],a)))}};t.b$a=function(){H7(this.q)||this.k.reset()};t.prb=function(){bsc(this.k)};t.c$a=function(){bsc(this.k)};
t.X3a=function(a){var b=a.ae;if(b&&b.j)if(Trc(b)){var c;c=b.getId();c=this.G.Vb(new Qrc(c));a="add_named_range"==a.type;if(!a||this.K.contains(c)){var d=b.jb();b.Pd()&&null!=d&&(d=Xrc(this.o,d))&&R7(this,a,c,d,b.sb().xd())}}else this.k.dispatchEvent("Be")};
t.n$a=function(a){a=a.docos||[];Gb(a);for(var b=0;b<a.length;b++){var c=this.G.Vb(new K7(a[b]));if(c){var d=P7(this,c),e;a:{e=this.C;if(d){var f=void 0;for(f in e.j){var h=e.j[f],l=Hrc(h,d);if(l){e={ab:h.Gb(),coord:l};break a}}}e=null}e?(R7(this,!1,c,e.ab,e.coord),R7(this,!0,c),this.k.dispatchEvent("Be")):this.K.contains(c)&&R7(this,!0,c)}}};
t.f$a=function(a){var b=TA(this.o);if(b){if((a=a.Gf)&&!Vw(a)){var c=Bl(b,a.y,a.x);a=c?c.xd():a}else a=null;b=PA(this.C,b);b=a?Jrc(b,a):[];c=this.k;c.j.clear();fd(c.j,b);c.wJ=a;c.dispatchEvent(new Q7("se",b,a))}};t.L7a=function(){if(!H7(this.q)){var a=this.k;if(a.fl&&a.pQ)a.pQ=!1;else{var b=!a.fl;S7(a);a.fl=b;a.dispatchEvent("ye")}}};t.J7a=function(){if(!H7(this.q)){var a=this.k;a.fl||(S7(a),a.pQ=!0,a.fl=!0,a.dispatchEvent("ye"))}};t.I7a=function(){if(!H7(this.q)){var a=this.k;a.fl&&a.pQ&&(S7(a),a.dispatchEvent("ye"))}};
t.orb=function(a){a.stopPropagation()};t.VTa=function(a){var b=P7(this,a);a=N7(this.o,this.B,b);if(!b||!a)return"";b=M7(this.B,b);a=$u(a,b).getDisplayValue();500<a.length&&(a=a.substring(0,499),a+="\u2026");return a};t.iWa=function(){var a;a=this.q;var b=a.j.getLinkedDoco();if(a=a.k.k[b]||null||"")(a=P7(this,a))?(b=M7(this.B,a),asc(this.k,a,b)):T.Yu.fireAction()};t.J3a=function(){var a=TA(this.o);$rc(this,a,jv(a))};t.S3a=function(){csc(this,!1)};t.T3a=function(){csc(this,!0)};
function csc(a,b){for(var c=dsc(a,b),d=Qv(a.o),e=TA(a.o),f=jv(e),h=PA(a.C,e),f=Grc(h,f,b),l=d;!f&&null!==l&&(l=c(l),e=l.Gb(),h=PA(a.C,e),f=Grc(h,null,b),l=l.De,l!=d););f&&null!==l&&(c=Jrc(h,f)[0],Ks(a.o,l,A(a.rrb,a,e,c,f)))}function dsc(a,b){var c;c=b?A(a.o.yqa,a.o):A(a.o.kX,a.o);return function(a){return c(a,0,!0,!0)}}t.rrb=function(a,b,c){asc(this.k,b,c);nv(a,c)};
t.L=function(){delete this.D;delete this.ba;delete this.G;delete this.M;delete this.q;delete this.C;delete this.B;delete this.Ra;delete this.o;delete this.Ea;M(this.V);delete this.V;M(this.P);delete this.P;M(this.k);delete this.k;M(this.J);delete this.J;Yrc.H.L.call(this)};function Q7(a,b,c){N.call(this,a);this.docos=b;this.o=b.length?b[0]:null;this.Z=c||null}B(Q7,N);function esc(){P.call(this);this.j=new ed}B(esc,P);t=esc.prototype;t.wJ=null;t.TK=null;t.Cs=null;t.fl=!1;t.pQ=!1;function asc(a,b,c){S7(a);a.Cs=b;a.TK=c;a.dispatchEvent(new Q7("ve",[b],c))}function bsc(a){a.fl||a.Cs||S7(a);a.dispatchEvent("Ce")}t.reset=function(){S7(this);this.dispatchEvent("Ae")};function S7(a){a.wJ=null;a.j.clear();a.TK=null;a.Cs=null;a.fl=!1;a.pQ=!1}t.L=function(){delete this.wJ;delete this.j;delete this.TK;delete this.Cs;esc.H.L.call(this)};function fsc(a,b,c,d,e,f,h,l){Xy.call(this,a,b,c,d,e,f,h,2,0,l)}B(fsc,Xy);fsc.prototype.Va=function(a){return eIa(this,a,"range-border cell-border waffle-docos-target-cell-border")};function gsc(a,b,c,d,e,f,h){P.call(this);this.q=a;this.ba=b;this.B=c;this.j=d;this.D=e;this.k=f;this.K=b.Z;this.o=b.j;this.G=b.B;this.J=L7.getInstance();this.Ea=h||Kg();this.C=new ed;this.M=new ed;this.Z=new ed;this.P=new ed;this.V=new R(this);hsc(this);this.V.F(this.o,"a",this.vrb).F(this.k,"se",this.qXa).F(this.k,"te",this.sXa).F(this.k,"re",this.pXa).F(this.k,"ue",this.CZa).F(this.k,"ve",this.srb).F(this.k,"Ce",this.urb).F(this.k,"Ae",this.trb).F(this.k,"xe",this.YZa).F(this.k,"Be",this.C6a).F(this.k,
"qe",this.AZa).F(this.k,"ze",this.DZa).F(this.k,"we",this.EZa).F(this.k,"ye",this.b5a);isc(this)}B(gsc,P);t=gsc.prototype;t.Mt=null;t.Y7="none";t.kca=500;t.jS=!1;t.EZa=function(){T7(this)};t.AZa=function(a){var b=a.o;b&&jsc(this,[b]);ksc(this,a.o)};t.DZa=function(a){var b=a.o;b&&lsc(this,[b]);ksc(this,a.o)};function ksc(a,b){var c=N7(a.o,a.G,b);if(c){var d=PA(a.K,c);k3a(a.j,c.jb(),Irc(d).length)}else msc(a)}t.b5a=function(){T7(this);this.k.fl&&nsc(this)};t.sXa=function(){T7(this)};
t.pXa=function(a){if(a.o){var b=a.o;this.jS=!0;a=this.q;b=this.J.Vb(b);a.j.highlightDoco(a.k.j[b]||0,void 0);this.jS=!1}else T7(this)};t.urb=function(){var a=this.k.Cs,b=this.C.isEmpty();this.k.fl?nsc(this):a?(osc(this,[a]),b&&!this.C.isEmpty()&&(this.jS=!0,b=this.q,a=this.J.Vb(a),b.j.highlightDoco(b.k.j[a]||0,void 0),this.jS=!1)):b||T7(this)};t.trb=function(){T7(this)};
function T7(a){a.C.clear();var b=a.q;b.j.flushDocoPositions(Mrc(b,{}));b=a.q;b.j.highlightDoco(b.k.j[""]||0,void 0);Q(a.D,!1);M(a.Mt);psc(a);qsc(a);a.k.fl||rsc(a);Krc(a.j,a.k.fl);isc(a)}t.isEmpty=function(){return this.C.isEmpty()&&this.Z.isEmpty()&&this.M.isEmpty()&&this.P.isEmpty()};function isc(a){var b=cu(a.B);b&&(a.kca=gGa(b.j)/2,a.q.setOption(Docos.OptionName.MAX_DOCO_HEIGHT,a.kca))}function qsc(a){ng(a.Z.vc());a.Z.clear()}function psc(a){ng(a.M.vc());a.M.clear()}
function rsc(a){E(a.P.vc(),function(a){km(a,"waffle-docos-target-cell-header")});a.P.clear()}t.qXa=function(a){this.k.Cs||this.k.fl||(a=a.docos,a.length?osc(this,a):ssc(this,!1))};function osc(a,b){H7(a.q)||lsc(a,gd(a.C,b).vc());jsc(a,b)}function nsc(a){var b=TA(a.o);b&&(b=PA(a.K,b),osc(a,Irc(b)),tsc(a),usc(a))}t.srb=function(a){vsc(this,a.o,a.Z)};
function vsc(a,b,c,d){var e=N7(a.o,a.G,b);if(e){var f=e.jb();if(wsc(a,b)){var h=xsc(a,c),l=function(){ysc(this,c)&&!h.equals(kv(e))?(qv(e,h),vsc(this,b,c,d)):($u(e,c).Ej()&&FE(cu(this.B)).setVisible(!1),zsc(this,c),osc(this,[b]),psc(this),qsc(this),rsc(this),Asc(this,c),Krc(this.j,this.k.fl),d&&Hg(function(){this.q.j.grabFocus()},0,this),this.dispatchEvent("pe"))};Ie?Sp(hu(lu(a.o,f)),A(e.Qs,e,h)).addCallback(l,a):Up(hu(lu(a.o,f)),A(e.Qs,e,h),A(l,a),new R)}else Sv(a.o,f,A(function(){this.q.j.grabFocus();
vsc(this,b,c,!0)},a))}else a.dispatchEvent("pe")}function zsc(a,b){var c=TA(a.o),d=cu(a.B);if(!a.jS&&c&&d){var e=d.j,d=d.k,f=Lx(e,"waffle",!1,!1),h=212;if(!e.xb()){var l=Qg("docs-docos-activitybox");l&&Zk(l)&&(h+=f.right-Xk(l).left)}l=Bsc(a,b);h=l.x-f.right+h;f=l.y-f.bottom+a.kca;if(!(0>=h&&0>=f)){d=d.j.xd();for(d=lf(d.y,d.x,d.y,d.x);oGa(e,d).height<f;)d.height+=1;for(;oGa(e,d).width<h;)d.width+=1;e=d.height;d=d.width;rv(c,Hma(c,Ema(c,hv(c),d,e)))}}}
function ysc(a,b){var c=TA(a.o);return Su(tl(c,"r"),b.y)&&Su(tl(c,"c"),b.x)}function xsc(a,b){return Bl(TA(a.o),b.y,b.x)||mf(b)}
t.CZa=function(a){if(!this.k.fl&&(psc(this),wsc(this,a.o)&&(ssc(this,!0),this.k.Cs!=a.o))){var b=this.J.Vb(a.o),c=this.q;c.j.isDocoResolved(c.k.j[b]||0)?(b=a.Z,a=cu(this.B),(c=TA(this.o))&&a&&b&&(b=Bl(c,b.y,b.x)||mf(b),b=bVa(a,b,"waffle-docos-target-cell-resolved-rect"),$w(fE(a),b,!0),b.setVisible(!0),this.M.add(b))):(c=a.Z,a=cu(this.B),(b=TA(this.o))&&a&&c&&(c=Bl(b,c.y,c.x)||mf(c),b=new fsc(b,a.J,a.K,a.C,a.j,a.k,new Wx(c),this.Ea),$w(fE(a),b,!0),this.M.add(b),b.setVisible(!0)))}};
function Csc(a,b){b&&(im(b,"waffle-docos-target-cell-header"),a.P.add(b))}function Asc(a,b){var c=cu(a.B),d=TA(a.o);d&&c&&b&&(d=Bl(d,b.y,b.x)||mf(b),d=bVa(c,d,"waffle-docos-target-cell-rect"),$w(fE(c),d,!0),a.Z.add(d),d.setVisible(!0),d.getElement()&&a.V.F(d.getElement(),["click","contextmenu","dblclick","mousedown","mouseup"],function(a){a.Gf=b;c.dispatchEvent(a)}))}function tsc(a){qsc(a);var b={};E(a.C.vc(),function(a){a=M7(this.G,a);var d=a.x+"-"+a.y;b[d]||(Asc(this,a),b[d]=!0)},a)}
function usc(a){rsc(a);var b=TA(a.o),c=cu(a.B);if(b&&c){var d=c.C,c=c.k,b=PA(a.K,b),e=c.Lf("r"),f=c.sg("r"),h=c.Lf("c"),l=c.sg("c");E(Irc(b),function(a){a=M7(this.G,a);a.x>=h&&a.x<=l&&Csc(this,PEa(d,a.x));a.y>=e&&a.y<=f&&Csc(this,d.j.getElement(Ww(d,"rh-",vv(d.o,a.y),null)))},a)}}t.C6a=function(){msc(this)};function msc(a){var b=mb(Xb(a.K.j),Number);E(b,function(a){var b=Xrc(this.o,a);b&&(b=PA(this.K,b),k3a(this.j,a,Irc(b).length))},a)}
t.YZa=function(a){if(a.o){var b=this.J.Vb(a.o);a=Bsc(this,a.Z);this.q.j.newDoco(b,a)}};
function jsc(a,b){for(var c={},d=[],e={},f=0;f<b.length;f++){var h=b[f],l=a.J.Vb(h),m;m=a;var n=h;if(cu(m.B)&&wsc(m,n)){var p=M7(m.G,n);m=Dsc(m,xsc(m,p))?m.k.fl||m.k.Cs==n||sb(m.k.j.vc(),n):!1}else m=!1;m?(m=M7(a.G,h),n=m=xsc(a,m),n=n.mb()+"-"+n.Ib()+"-"+n.kb()+"-"+n.Pb()+"-"+n.j+"-"+n.Yc,e[n]=e[n]||0,c[l]=Bsc(a,m.xd(),e[n]),e[n]++,a.C.add(h)):d.push(h)}a.C.isEmpty()||ssc(a,!0);$b(c)||(e=a.q,e.j.updateDocoPositions(Mrc(e,c)));H7(a.q)||lsc(a,d)}
function lsc(a,b){var c=a.C.vp(b).vc();a.C.Hb(c);c=mb(c,function(a){return this.J.Vb(a)},a);c.length&&Lrc(a.q,c);a.C.isEmpty()&&ssc(a,!1)}
function Bsc(a,b,c){var d=cu(a.B),e=TA(a.o),f=d.j,h=f.xb(),l=xsc(a,b),m=Mx(f,l),n=c?15*c:0;c=h?m.left-n:m.right+n;var l=m.top+n,p=a.k.fl;a=$e(a.k.TK,b);var r=$u(e,b).Ej();p||a||!r?(b=l+125,0<b-gGa(f)&&(e=e.on("r")-1,Jx(f,b,"r","waffle")>=e&&(l-=50))):(a=FE(d),p=a.Xr,gWa(d,cv(e,b).xd()),e=a.D.height?a.Cb:0,b=a.G.height,d=Math.min(GHa.height,e+b),b&&(d=d+30+12,d+=Qy.top,d+=Qy.bottom),e&&(d+=12,d+=Qy.top,d+=Qy.bottom),e=d,Sx(a,p),l+=e);m=h?m.right+n+212:m.left-n-212;n=h?0>c-212:c+212>Ax(f);e=h?m>Ax(f):
0>m;n&&!e&&(c=m);return new Docos.Point(h?Ex(f,c,"c"):c,l)}function wsc(a,b){var c=N7(a.o,a.G,b),d=TA(a.o);return!!c&&c==d}function Dsc(a,b){if(!b)return!1;var c=Nrc(cu(a.B)),d=!1,e=b.xd();uea(b,function(a,b){var l;if(l=a==e.y)l=null!=JD(c,new F(b,a));return l?d=!0:!1});return d}t.vrb=function(){hsc(this)};function hsc(a){var b=cu(a.B);b&&(a.Ea.appendChild(b.e3,a.D),a.q.setOption(Docos.OptionName.LAYOUT_RTL,b.j.xb()),a.q.setOption(Docos.OptionName.ANCHOR_DIV,a.D),a.q.j.renderAnchorSurface())}
function ssc(a,b){var c,d=a.D.style;c="";"opacity"in d?c=d.opacity:"MozOpacity"in d?c=d.MozOpacity:"filter"in d&&(d=d.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(c=String(d[1]/100));c=""==c?c:Number(c);c=sa(c)?1:c;Zk(a.D)||(c=0);d=b&&1>c?"in":!b&&0<c?"out":"none";"none"==d?(M(a.Mt),Q(a.D,b)):a.Mt&&1==a.Mt.va&&a.Y7==d||(M(a.Mt),Q(a.D,!0),a.Mt=new pw(a.D,c,"in"==d?1:0,250),a.Y7=d,"out"==d&&zg(a.Mt,"finish",A(a.N_a,a)),a.Mt.play())}t.N_a=function(){T7(this);var a=cu(this.B);a&&jE(a)};
t.L=function(){delete this.B;delete this.D;delete this.J;delete this.q;delete this.C;delete this.k;delete this.K;delete this.Ea;delete this.Y7;delete this.G;delete this.o;delete this.ba;M(this.Mt);delete this.Mt;qsc(this);psc(this);rsc(this);M(this.V);delete this.V;gsc.H.L.call(this)};function Esc(a,b,c,d,e,f){K.call(this);this.G=a;this.K=w(b)?b:!0;this.J=w(c)?c:1;this.o=new yp(A(this.PPa,this),d||1E3,e||6E4,f);L(this,this.o);this.B=new Sl(void 0,this);this.j=null;this.C=[];this.q="DCS_Callback"+String(Fsc++);this.D=this.k=null}B(Esc,K);var Fsc=0;t=Esc.prototype;t.l7=function(){this.j=null;this.o.stop();this.B.callback(this.C)};
t.Lna=function(a){a instanceof Tl||(a instanceof nn&&3==a.code?this.l7():(this.j=null,this.C.push(a instanceof Error?a.message:""),0<this.J--?this.o.start():this.B.errback(this.C)))};t.Obb=function(){this.o.yb()||this.o.start();var a=new Sl;Xl(this.B,a);return a};
t.PPa=function(){if(this.K){this.k=new Hw(this.G);this.k.Og=1E4;var a=A(this.l7,this);fa(this.q,a,void 0);this.D=this.k.send({callback:this.q},void 0,A(this.Lna,this))}else this.j&&this.j.cancel(),this.j=QLb(this.G,"dcs_main_js",{timeout:1E4}),Ul(this.j,this.l7,this.Lna,this)};t.L=function(){this.j&&this.j.cancel();this.B.cancel();ea[this.q]&&(ea[this.q]=ia);this.k&&this.D&&this.k.cancel(this.D);Esc.H.L.call(this)};function Gsc(){return'<div class="docs-docos-activitybox" aria-label="Comment stream box."><div class="docs-docos-activitybox-inner"></div></div>'};function U7(a,b){Bm.call(this,b);this.j=a}B(U7,Bm);t=U7.prototype;t.k7=null;t.sN=null;t.eO=null;t.Im=null;t.Oka=!1;t.Pa=function(){U7.H.Pa.call(this);var a=this.Q(),b=st(Gsc,{},{},a);this.aa=b;sh(b,!0);this.sN=a.getElement("docs-docos-caret");this.k7=Bh(a,"docs-docos-activitybox-inner",b);this.j&&(im(b,"docos-enable-new-header"),im(this.sN,"docos-enable-new-header"))};
t.xa=function(){this.eO=new Ev(this.getElement());this.eO.Yi("close-box",27);this.Im=new Im(this.getElement(),"toggle_display");Jm(this.Im,!0);var a=this.Im;pna(a);a.Caa=!1;this.Im.Foa=!1;S(this).F(this.eO,"shortcut",this.X7a).F(this.Im,"show",this.ieb).F(this.Im,"hide",this.geb).F(this.Im,"beforeshow",this.feb).F(this.Im,"beforehide",this.eeb)};t.pb=g("k7");t.ieb=function(){Q(this.sN,!0);this.dispatchEvent("show")};t.geb=function(){Q(this.sN,!1)};t.feb=function(){return this.dispatchEvent("beforeshow")};
t.eeb=function(){return this.Oka?!1:this.dispatchEvent("hide")};t.setVisible=function(a){this.Im.setVisible(a)};t.Qa=function(){return!!this.Im&&this.Im.Qa()};t.X7a=function(a){switch(a.j){case "close-box":this.setVisible(!1)}};t.L=function(){M(this.eO);delete this.eO;delete this.sN;delete this.k7;M(this.Im);delete this.Im;U7.H.L.call(this)};function Hsc(a,b,c,d){P.call(this);this.o=c||new Lg;this.j=a;this.C=!!b;this.k=new U7(this.j.isDocsStreamHeaderEnabled&&this.j.isDocsStreamHeaderEnabled(),this.o);this.O=new R(this);this.B=new ZC(void 0,void 0,!0,NJ.getInstance());this.q=d||T.Rha;this.j.onReady(A(this.neb,this))}B(Hsc,P);t=Hsc.prototype;t.Sy=null;t.Kua=!1;t.render=ba();
t.neb=function(){var a=this.o.getElement("docs-docos-commentsbutton");this.Sy=lW(null);wy(this.Sy,16);this.Sy.Ta(a);Fd(Id(),"docosUnreadCommentsEnabled")&&(this.j.setListener(Docos.EventType.UNREAD_COMMENTS,this.Ieb,this),this.j.setOption(Docos.OptionName.ENABLE_UNREAD_COMMENTS,!0),T.Yu.gc(lq,this.ULa,this));dD(this.B,this.Sy,T.Yu,eD);T.Yu.gc(lq,this.xib,this);this.k.render(a.parentNode.parentNode);Q(this.k.getElement(),!1);T.Yu.ga(!0);this.j.setOption(Docos.OptionName.PANE_DIV,this.k.pb());this.j.setOption(Docos.OptionName.PANE_KB_DIV,
this.k.getElement());this.j.renderPaneSurface();this.j.setListener(Docos.OptionName.DIALOG_OPENED,A(this.lya,this));this.j.setListener(Docos.OptionName.DIALOG_CLOSED,A(this.lya,this));this.j.setOption(Docos.OptionName.SORT_PANE,!0);this.j.setOption(Docos.OptionName.STREAM_BUTTON,a);Docos.EventType.CREATE_DRAFT&&(this.j.setListener(Docos.EventType.CREATE_DRAFT,this.rOa,this),this.q.gc(jq,this.kya,this),this.kya(new qva("enabled",this.q.isEnabled(),!1)));this.C||this.j.setListener(Docos.EventType.NETWORK_ERROR,
this.ceb,this);this.O.F(this.k,["show","hide"],this.edb)};t.lya=function(a){this.k.Oka=a.type==Docos.OptionName.DIALOG_OPENED};t.kya=function(a){this.j.setOption(Docos.OptionName.ENABLE_COMMENT_BUTTON,a.newValue)};t.rOa=function(){this.k.setVisible(!1);this.q.fireAction()};t.xib=function(){var a=this.k;a.Im&&!qna(a.Im)&&a.Im.setVisible(!0)};
function Isc(a,b){if(0>b)throw Error("Number of unread comments cannot be negative");ry(a.Sy,"docs-docos-commentsbutton-unread",0<b);var c=a.o.getElement("docs-docos-commentsbutton");a.o.Pf(c,String(b))}t.Ieb=function(){var a=this.j.getUnreadCommentsCount();Isc(this,a)};t.ULa=function(){Isc(this,0);this.j.ackUnreadComments()};
t.ceb=function(){if(!this.Kua&&T.Mi.isEnabled()){if(this.j.hasPendingContent()){var a=Qo("Failed to post comment due to a network error.","warning",!0);Oo.getInstance().postMessage(a)}this.j.setOption(Docos.OptionName.FATAL_READONLY,!0);this.j.setOption(Docos.OptionName.SHOW_ERRORS,!0);T.Rha.ga(!1,"docos-fatal-reason");this.Kua=!0}};t.edb=function(a){a="show"==a.type;this.j.setOption(Docos.OptionName.SORT_PANE,!a);this.Sy.bc(a);a?this.j.grabFocus():this.dispatchEvent("activity-box-closed")};
t.L=function(){M(this.Sy);delete this.Sy;M(this.O);delete this.O;M(this.k);delete this.k;M(this.B);delete this.B;delete this.j;Hsc.H.L.call(this)};function Jsc(){K.call(this)}B(Jsc,pn);t=Jsc.prototype;t.WSa=function(){return Esc};t.sTa=function(){return Hsc};t.pTa=function(){return Yrc};t.qTa=function(){return esc};t.rTa=function(){return gsc};xn("docos",Jsc);
