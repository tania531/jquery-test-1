ij.prototype.MO=Z(58,function(a){return H(this,2,a)});function eRb(a,b){var c=new sW,d;for(d in a.j)d in b.j||(c.j[d]=null);return c}function fRb(a){return""+hMb(Bt(a,{d7:"docs-icon-close-small"}))}
function gRb(a){return"<div"+(a.id?' id="'+W(a.id)+'"':"")+' class="'+(a.Be?W(a.Be)+" ":"")+'goog-flat-menu-button goog-flat-menu-button-disabled goog-inline-block" role="button" '+(a.Qo?'aria-label="'+W(a.Qo)+'"':"")+'><div class="goog-flat-menu-button-caption goog-inline-block">'+Lt(a.nr)+'</div><div class="goog-flat-menu-button-dropdown goog-inline-block" aria-hidden="true">&nbsp;</div>'+(a.Gi?Lt(a.Gi):"")+"</div>"}function hRb(){this.RW=this.Jm=null}
hRb.prototype.Da=function(){return new ZC(this.Jm||void 0,void 0,!0,this.RW||NJ.getInstance())};function iRb(a,b){QI.call(this);this.va=a;this.j[a]=b}B(iRb,QI);iRb.prototype.k=function(a){var b={};b[this.va]=a;RI(this,b)};function gY(){xL.call(this);this.j=new sW;zL(this,new wL(yL,{},{wordList:[]}))}B(gY,xL);ja(gY);gY.prototype.k=function(a){jRb(this,a,!0)};function jRb(a,b,c){var d=a.j.contains(b.toLowerCase()),e=b.toLowerCase();a.j.add(e);if(!d){var f={};f.value=e;AL(a).get("wordList").push(f);c&&kRb(a,[b],[])}return!d}gY.prototype.q=function(a){lRb(this,a,!0)};
function lRb(a,b,c){var d=a.j.contains(b.toLowerCase());if(d){var e=b.toLowerCase();a.j.remove(e);for(var f=AL(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&kRb(a,[],[b])}return d}gY.prototype.o=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)jRb(this,a[b].value,!1);a.length&&this.dispatchEvent("userDictionaryChange")};
function kRb(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.dispatchEvent("userDictionaryChange");a.dispatchEvent(new CL(a,new BL("docs-user_dictionary",d),AL(a)))};function hY(a,b,c){ht.call(this,a,b,c);Mm(this,"Preferences")}B(hY,ht);t=hY.prototype;t.xa=function(){hY.H.xa.call(this);S(this).F(this,"dialogselect",this.vPa)};t.setVisible=function(a){hY.H.setVisible.call(this,a);a&&this.update()};t.update=ia;t.vPa=function(a){"ok"==a.key&&this.CAa()};t.CAa=ia;function mRb(a){return a=""+('<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input jfk-textinput" type="text" aria-label="'+W(a.Jva)+'" placeholder="'+W(a.Jva)+'"></div><div class="docs-userdictionarydialog-button-add-container">'+Jy({Dd:"docs-userdictionarydialog-button-add",style:0,Ze:"Add"})+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>')};function nRb(a){return'<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+W(a.LL)+'" class="docs-userdictionarydialog-row-content">'+W(a.LL)+"</div></div>"};function iY(a,b){py.call(this,void 0,new oRb);this.uha=a;this.j=b}B(iY,py);iY.prototype.qo=ba();iY.prototype.XI=function(a){a.relatedTarget&&nh(this.j,a.relatedTarget)||iY.H.XI.call(this,a)};iY.prototype.pj=function(a){return(46==a.keyCode||8==a.keyCode)&&this.Hi(a)};function oRb(){}B(oRb,ky);oRb.prototype.Kb=q("docs-userdictionarydialog-row-container");oRb.prototype.Fg=function(a){return st(nRb,{LL:a.uha})};function jY(a){hD.call(this,void 0,new pRb);this.k=a;this.j=this.o=null}B(jY,hD);t=jY.prototype;t.xa=function(){jY.H.xa.call(this);fm(this.aa,"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");am(this.aa,"listbox");var a=this.o;Q(a,!1);al(a,!0);this.j=new Ot(a);S(this).F(this,"action",this.sda).F(this.o,"click",this.sda).F(this.j,"key",this.aXa)};t.Zc=function(){jY.H.Zc.call(this);M(this.j);this.j=null};
function qRb(a){var b=[];a.nf(function(a){b.push(a.uha)});return b}t.sda=function(){var a;a=kD(this);var b=this.ap()==this.Sb()-1;mD(this);this.removeChild(a,!0);b||nD(this);rRb(this);this.dispatchEvent("change")};t.aXa=function(a){return 13==a.keyCode||32==a.keyCode?(this.sda(),a.preventDefault(),a.stopPropagation(),!0):!1};t.VD=function(){0==Dm(this,"docs-userdictionarydialog-row-container-hover").length&&lD(this)};t.vw=function(a){a.stopPropagation();a.preventDefault()};
t.gi=function(a){return 27==a.keyCode?!1:jY.H.gi.call(this,a)};t.fP=function(a){jY.H.fP.call(this,a);rRb(this)};t.D9=function(a){var b=xh(document);jY.H.D9.call(this,a);b&&hm(b,"docs-userdictionarydialog-list-remove-button")?this.aa.focus():rRb(this)};function rRb(a){if(kD(a)){var b;b=kD(a);var c=Math.round((Wk(b.aa).height-Wk(a.o).height)/2);a.o.style.top=Jk(b.aa).y+c+"px";fm(a.o,"Remove "+b.uha);Q(a.o,!0)}else Q(a.o,!1)}function pRb(){this.j=void 0}B(pRb,gD);
pRb.prototype.sp=function(a){var b=st(fRb,{enabled:!0,Be:"docs-userdictionarydialog-list-remove-button"});a.o=b;a.getElement().appendChild(b)};function kY(a,b,c,d){hY.call(this,b,c,d);this.G=a;this.o=new Ky(null,d);this.Ia(this.o);this.cc=this.j=null;this.C=new jY(a);this.Ia(this.C);this.D=null;Mm(this,"Personal dictionary");a=Ym((new Tm).set("ok","Save",!0),$m,!1,!0);Wm(this,a)}B(kY,hY);t=kY.prototype;t.Pa=function(){kY.H.Pa.call(this);qt(this.pb(),mRb,{Jva:"Add a new word"});qG(this,"ok");this.o.Ta(Em(this,"docs-userdictionarydialog-button-add"));this.C.Ta(Em(this,"docs-userdictionarydialog-list-container"));this.j=Em(this,"docs-userdictionarydialog-input")};
t.xa=function(){kY.H.xa.call(this);this.o.ga(!1);this.cc=new iy(this.j);S(this).F(this.o,"action",this.lWa).F(this.j,"keypress",this.sRa).F(this.cc,"input",this.rRa).F(this.C,"change",this.qZa);S(this).F(this.o.getElement(),"focus",this.C7).F(this.j,"focus",this.C7);for(var a=this.k.aa.getElementsByTagName("BUTTON"),b=0;b<a.length;b++)S(this).F(a[b],"focus",this.C7);this.D=new xI(this.C)};t.Zc=function(){kY.H.Zc.call(this);ng(this.cc,this.D);this.D=this.cc=null};t.lWa=function(){sRb(this)};
t.rRa=function(){this.o.ga(!Ja($a(this.j.value)))};t.sRa=function(a){13==a.keyCode&&(this.o.isEnabled()&&sRb(this),a.stopPropagation(),a.preventDefault())};t.C7=function(){this.C.Xi(-1)};t.qZa=function(){Xm(this.k,"ok").disabled=!1};t.update=function(){var a=this.C;a.pd(!0);var b=a.k.j.vc();b.sort(xMb());for(var c=0;c<b.length;c++)a.Ia(new iY(b[c],a.o),!0);tRb(this,"");Xm(this.k,"ok").disabled=!0};
t.CAa=function(){var a,b;a=this.C;b=new sW(a.k.j.vc());var c=new sW(qRb(a));a=eRb(c,b).vc();b=eRb(b,c).vc();for(var c=this.G,d=[],e=[],f=0;f<a.length;f++)jRb(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)lRb(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&kRb(c,d,e)};t.setVisible=function(a){kY.H.setVisible.call(this,a);if(a){var b=this.j;b&&(b.focus(),a=b.value.length,eEa(b)?(b.selectionStart=a,b.selectionEnd=a):nd&&(a=gEa(b,a),b=b.createTextRange(),b.collapse(!0),b.move("character",a),b.select()))}};
function tRb(a,b,c){a.j.value=b;a.o.ga(!Ja($a(a.j.value)));c&&a.j.select()}function sRb(a){var b=a.C,c=a.j.value,c=c.toLowerCase().trim();-1==qRb(b).indexOf(c)&&(c=new iY(c,b.o),b.lk(c,0,!0),b.aa.scrollTop=0,b.dispatchEvent("change"));DT(a.Q())==a.j&&a.j.blur();tRb(a,"");a.j.focus()};function uRb(a,b){var c=new kY(gY.getInstance());a.qi(c);return za(vRb,c,b)}function vRb(a,b,c){a.setVisible(!0);b().setVisible(!1);c&&tRb(a,c,!0)};function wRb(){P.call(this);this.j=new ed}B(wRb,P);function xRb(a,b,c,d,e,f,h,l){this.j=a;this.D=b instanceof Element?Ac(b):b;this.G=c;this.J=d;this.k=e;this.o=f;this.q=h;this.B=l||null;this.O=new R(this);L(this,this.O)}B(xRb,K);t=xRb.prototype;t.qRa=function(a){var b=this.k.j;yRb(this.o,a);lY(this,b,!0)};
t.uXa=function(a){var b=this.k.j,c=this.o,d=Xa(a.Wt().getOriginalWord()),e=a.k;a=new Kq;J(a,1,"\\b"+d+"\\b");J(a,3,e);J(a,6,!1);J(a,7,!1);J(a,8,!0);a.Hc(2);J(a,11,0);var f,d=c.j.o;switch(c.j.K){case "RANGE":J(a,5,0);f=Zn(d.rect,d.hc);J(a,9,f);f=lu(c.k,d.hc);break;case "SHEET":J(a,5,1);f=new ki;J(f,1,""+d.hc);J(a,9,f);f=lu(c.k,d.hc);break;case "WORKBOOK":J(a,5,2),f=c.k.kX(-1,0,!1)}f=f.Gb();c.o.Mb(new MW(f,0,a));lY(this,b,!0)};
t.e1a=function(a){var b=this.k.j;if(a){var c=this.J;c.j.contains(a.toLowerCase())||(c.j.add(a.toLowerCase()),c.dispatchEvent("ignoreWhitelistChange"))}lY(this,b,!1)};t.BYa=function(a){var b=this.k.j;if(a){var c=this.o.q,d=a.Wt().getOriginalWord();a=a.getSelection();if(!zRb(c,d,a)){var e=c.j[""+a.hc];e||(e=Vn(c.o,a.hc),e.getSheetType(),e=e.Gb(),e=new su(e,!0),c.j[""+a.hc]=e);c=a.Lb.y;a=a.Lb.x;var f=e.Jd(c,a);f||(f=new ed,tu(e,c,a,f));f.add(d.toLowerCase())}}lY(this,b,!1)};
t.M4a=function(a){var b=this.k.j;a&&(this.B?this.B.k(a):gY.getInstance().k(a));lY(this,b,!1)};t.Msa=function(){T.g4.od(!1);this.O.kc(this.j,"close",this.Msa);Uya(it.getInstance())||this.G.j(3);ARb(this.o.j);if(!T.Mi.isEnabled()){var a=Oo.getInstance(),b=Qo("Spellcheck will be unavailable until you reconnect.","info",!0,1E4);a.postMessage(b)}};
t.Ota=function(a){var b=this.j;Q(b.ba,!1);Q(b.Oa,!0);var b=this.k,c=A(this.SEa,this,this.k.j,!1);this.q.um().getSelection();b.j&&(a?b.C.unshift(b.j):b.M.push(b.j));BRb(b,c,!!a)};function lY(a,b,c){var d=a.j;Q(d.ba,!1);Q(d.Oa,!0);b=A(a.SEa,a,b,c);a.q.um().getSelection();BRb(a.k,b,!1)}
t.SEa=function(a,b){this.j.setVisible(!0);var c=this.j;Q(c.ba,!0);Q(c.Oa,!1);var c=this.k.j,d=this.j,e=this.K,f=this.C;Ig(d.Bb);var h=Bh(d.Q(),"docs-slidingdialog-content",d.getElement());h&&bm(h,"label",c?"Spellcheck":"No spelling suggestions");if(c){e=c.Wt();f=d.Q();S(d).kc(d.o,"focus",d.bua).kc(d.o,"blur",d.aua).kc(d.G,"input",d.dua).kc(d.o,"keydown",d.cua);d.B.Na("");var h=d.o,l=f.Hg(f.RTa(h));fh(l,h);d.o=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!d.o)throw Error("Replacement input not in DOM.");
M(d.removeChild(d.B));d.B=new bU("",f);d.Ia(d.B);d.B.Ta(d.o);M(d.G);d.G=new iy(d.o);for(S(d).F(d.o,"focus",d.bua).F(d.o,"blur",d.aua).F(d.G,"input",d.dua).F(d.o,"keydown",d.cua);0<d.k.Sb();)d.k.Kq(0).dispose();f="Next misspelling. Change "+(e.getOriginalWord()+" to:");bm(d.o,"label",f);d.Q().Pf(d.jf,e.getOriginalWord());f=e.j;if(0==f.length)d.B.Na(e.getOriginalWord()),h=new qD("No suggestions"),d.k.Ia(h,!0),h.gf(2,!1),h.ga(!1),d.td.k(!1);else{d.B.Na(f[0]);for(e=0;e<f.length;e++)h=new qD(f[e]),d.k.Ia(h,
!0),S(d).F(h,"action",d.B9a).F(h.getElement(),"dblclick",d.T2a),1<f.length&&(h.vq(!0),h=Qg("goog-menuitem-checkbox",h.aa),im(h,"goog-inline-block"));(e=d.k.dc(0))&&1<d.k.Sb()&&e.bc(!0);d.k.Xi(0);d.td.k(!0)}eMb(d.Va,c.getSelection());d.mfb.call(d,0,-1);CRb(d.M);d.lfb.call(d,-1);CRb(d.J);Q(d.lb,!1);Q(d.fb,!0)}else Q(d.fb,!1),$g(d.Uc),e&&d.Uc.appendChild(e),Q(d.lb,!0),e=w(f)?f:5E3,d.Bb=Hg(A(d.qp,d),e),d.Va.Kv();this.j.focus();c?DRb(this.o,c.getSelection()):b&&DRb(this.o)};function ERb(a,b){this.k=a;this.j=b}ERb.prototype.Wt=g("j");function FRb(a,b,c){this.j=a;this.o=b;this.k=c||null}FRb.prototype.getOriginalWord=g("o");function mY(a,b,c,d,e){wW.call(this,e);this.D=a;this.C=b;this.Va=new vW(c);this.Ia(this.Va);this.P=new Ky(null,e);this.Ia(this.P);this.J=new vD(e);this.Ud=new sI(null,this.J,QM.getInstance());this.Ia(this.Ud);this.Xa=new Ky(null,e);this.Ia(this.Xa);this.M=new vD(e);this.ge=new sI(null,this.M,QM.getInstance());this.Ia(this.ge);this.Ub=this.V=this.K=null;this.B=new bU("",e);this.Ia(this.B);this.k=new GRb(e);wD(this.k,!1);this.Ia(this.k);this.Bb=this.jf=this.Uc=this.lb=this.fb=this.G=this.o=null;this.td=
d;this.ba=this.Oa=this.Ua=null}B(mY,wW);function CRb(a){jm(a.aa,["goog-menu-no-icon","goog-menu-noaccel"])}t=mY.prototype;
t.G7=function(){var a;a="";var b;b=""+('<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+XLb()+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><label class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:</label><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false"></input>'+fMb({id:"docs-spellcheckslidingdialog-replacement-context"})+
"</td><td>"+Jy({id:"docs-spellcheckslidingdialog-button-change",style:2,Dd:"docs-spellcheckslidingdialog-buttons-action",Ze:"Change"})+gRb({id:"docs-spellcheckslidingdialog-button-change-menu",nr:""})+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">'+Jy({id:"docs-spellcheckslidingdialog-button-ignore",style:0,Dd:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",Ze:"Ignore"})+
gRb({id:"docs-spellcheckslidingdialog-button-ignore-menu",Be:"docs-spellcheckslidingdialog-buttons-white-menu",nr:""})+"<br/>"+Jy({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,Dd:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",Ze:"Add to Dictionary"})+gRb({id:"docs-spellcheckslidingdialog-button-dictionary-menu",Be:"docs-spellcheckslidingdialog-buttons-white-menu",nr:""})+"</td></tr></tbody></table></div></div></div>");return a=a+iMb({gna:"Spellcheck",
Ze:""+b})};
t.xa=function(){mY.H.xa.call(this);im(this.aa,"docs-spellcheckslidingdialog");var a=this.Q();this.Oa=a.getElement("docs-spellcheckslidingdialog-loading");this.ba=a.getElement("docs-spellcheckslidingdialog-content");this.lb=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.Uc=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.fb=a.getElement("docs-spellcheckslidingdialog-misspellings");this.o=a.getElement("docs-spellcheckslidingdialog-replacement-input");this.G=
new iy(this.o);this.jf=a.getElement("docs-spellcheckslidingdialog-original-word");this.Va.Ta(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.B.Ta(this.o);this.P.Ta(a.getElement("docs-spellcheckslidingdialog-button-change"));this.Xa.Ta(a.getElement("docs-spellcheckslidingdialog-button-ignore"));HRb(this.Ud,this.P,"docs-spellcheckslidingdialog-button-change-menu",T.zja,this.D,a);HRb(this.ge,this.Xa,"docs-spellcheckslidingdialog-button-ignore-menu",T.Bja,this.D,a);this.k.Ta(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
oD(this.k,!0);CRb(this.k);dD(this.D,this.Xa,T.f3,eD,A(this.C.V,this.C));dD(this.D,this.P,T.rT,eD,A(this.fUa,this));this.K=new Ky(null,this.Q());this.V=new vD(a);this.Ub=new sI(null,this.V,QM.getInstance(),a);this.Ia(this.K);this.Ia(this.Ub);this.K.Ta(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));dD(this.D,this.K,T.L3,eD,A(this.PO,this,this.C));HRb(this.Ub,this.K,"docs-spellcheckslidingdialog-button-dictionary-menu",T.Aja,this.D,a);var a=new qD("View personal dictionary..."),b=ec(eD);
delete b["node-label"];delete b.label;dD(this.D,a,T.eC,b,A(this.PO,this,this.C));this.V.Ia(a,!0);CRb(this.V);S(this).F(this.k.getElement(),nd?qfa:"focus",this.w8a);this.Ua=new jCb(this.getElement());L(this,this.Ua);a=PBb("Ctrl+single-quote",!1);b=PBb("Ctrl+semicolon",!1);WBb(this.Ua,T.h4,a);WBb(this.Ua,T.i4,b)};t.focus=function(){Zk(this.fb)?this.B.hj():this.lb.focus()};
function HRb(a,b,c,d,e,f){c=f.getElement(c);a.Ta(c);$V(a,1);nBb(a,b.getElement());$V(b,2);if(b=new Jw(c,a.Sd()?1:3))a.D=b,a.V=b.element;dD(e,a,d,eD)}t.lfb=function(a){for(;0<this.J.Sb();)this.J.Kq(0).dispose();var b=Ug("span","docs-spellcheckslidingdialog-menu-text","Change all");a=Ug("span","docs-spellcheckslidingdialog-count",0>a?"":"("+(a+" found)"));var c=[];c.push(b);c.push(a);b=new qD(c);dD(this.D,b,T.k2,void 0,A(this.xOa,this));this.J.Ia(b,!0)};
t.mfb=function(a,b){for(;0<this.M.Sb();)this.M.Kq(0).dispose();var c=Ug("span","docs-spellcheckslidingdialog-menu-text","Ignore all"),d=Ug("span","docs-spellcheckslidingdialog-count",0>b?"":"("+(b+" found)")),e=[];e.push(c);e.push(d);c=new qD(e);dD(this.D,c,T.g3,void 0,A(this.PO,this,this.C));this.M.Ia(c,!0)};function IRb(a){var b=a.B.Y();a=new FRb(b,a.PO(a.C),a.C);T.rT.fireAction(a)}t.T2a=function(){IRb(this)};t.bua=function(){var a=this.Q().kw(this.o);im(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};
t.aua=function(){var a=this.Q().kw(this.o);km(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};t.cua=function(a){13==a.keyCode&&IRb(this)};t.w8a=function(){for(var a=0;a<this.k.Sb();a++){var b=this.k.dc(a);if(b.xc()){b.ef(!0);return}}0<this.k.Sb()&&this.k.Xi(0)};function JRb(a){for(var b=0;b<a.k.Sb();b++)a.k.dc(b).bc(!1)}t.dua=function(){JRb(this);this.td.k(!0)};t.B9a=function(a){var b=a.target.Y();JRb(this);this.B.Na(b);(a=a.target)&&1<this.k.Sb()&&a.bc(!0);this.B.hj()};
t.fUa=function(){var a=this.B.Y();return new FRb(a,this.PO(this.C),this.C)};t.xOa=function(){var a=this.C,a=a.j?a.j.Wt():null;return new ERb(this.B.Y(),a)};t.PO=function(a){return(a=a.j)?a.Wt().getOriginalWord():null};t.L=function(){Ig(this.Bb);M(this.G);mY.H.L.call(this)};function GRb(a,b){vD.call(this,a,b)}B(GRb,vD);GRb.prototype.gi=function(a){return 27==a.keyCode?!1:GRb.H.gi.call(this,a)};function KRb(a){var b="";a='<b>"'+(W(a.LL)+'"</b> added to your personal dictionary.');return xt(b+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}function LRb(a){var b="";a='<b>"'+(W(a.LL)+'"</b> removed from your personal dictionary.');return xt(b+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))};function MRb(a,b){this.B=a;this.j=b;this.o=0}MRb.prototype.k=function(a){this.B.k(a);a=So(st(KRb,{LL:a}),T.Oo.Ch(),A(this.q,this,a),"info",!0,1E4);Po(this.j,this.o);this.o=this.j.postMessage(a)};MRb.prototype.q=function(a){this.B.q(a);a=So(st(LRb,{LL:a}),T.Oo.Ch(),A(this.k,this,a),"info",!0,1E4);Po(this.j,this.o);this.o=this.j.postMessage(a)};function NRb(a){K.call(this);this.o=a;this.j={};this.k=new R(this);L(this,this.k);this.k.F(a,"k",this.q)}B(NRb,K);function zRb(a,b,c){if(a=a.j[""+c.hc])if(c=a.Jd(c.Lb.y,c.Lb.x))return!!c.contains(b.toLowerCase());return!1}NRb.prototype.q=function(a){M(this.j[""+a.Mg]);delete this.j[""+a.Mg]};function nY(){G.call(this)}var ORb;B(nY,G);nY.prototype.rangeCount=function(){return Hf(this,2)};function oY(){G.call(this)}var PRb;B(oY,G);oY.prototype.jb=function(){return H(this,1)};function pY(){G.call(this)}var QRb;B(pY,G);function qY(){G.call(this)}var RRb;B(qY,G);qY.prototype.MO=function(){return H(this,2)};function rY(){G.call(this)}var SRb;B(rY,G);rY.prototype.getOriginalWord=function(){return H(this,1)};
nY.prototype.U=function(){ORb||(ORb=Nf(nY,{0:{name:"SpellcheckRequest",hb:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",R:5,type:Number},2:{name:"range",R:11,type:ki},3:{name:"search_all_sheets",R:8,type:Boolean},4:{name:"active_filter_views",Dc:!0,R:11,type:oY}}));return ORb};nY.ctor=nY;nY.ctor.U=nY.prototype.U;
oY.prototype.U=function(){PRb||(PRb=Nf(oY,{0:{name:"FilterViewDataProto",hb:"ritzproto.FilterViewDataProto"},1:{name:"grid_id",R:9,type:String},2:{name:"filter_view_id",R:9,type:String}}));return PRb};oY.ctor=oY;oY.ctor.U=oY.prototype.U;
pY.prototype.U=function(){QRb||(QRb=Nf(pY,{0:{name:"SpellcheckResponse",hb:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",R:5,type:Number},2:{name:"last_column_searched",R:5,type:Number},3:{name:"last_grid_id_searched",R:9,type:String},4:{name:"searched_all_sheets",R:8,type:Boolean},6:{name:"searched_whole_range",R:8,type:Boolean},5:{name:"cell_suggestions",Dc:!0,R:11,type:qY}}));return QRb};pY.ctor=pY;pY.ctor.U=pY.prototype.U;
qY.prototype.U=function(){RRb||(RRb=Nf(qY,{0:{name:"CellSuggestionsProto",hb:"ritzproto.CellSuggestionsProto"},1:{name:"phrase_suggestions",Dc:!0,R:11,type:rY},2:{name:"cell",R:11,type:Nh}}));return RRb};qY.ctor=qY;qY.ctor.U=qY.prototype.U;
rY.prototype.U=function(){SRb||(SRb=Nf(rY,{0:{name:"PhraseSuggestionsProto",hb:"ritzproto.PhraseSuggestionsProto"},1:{name:"original_word",R:9,type:String},2:{name:"offset_start_index",R:5,type:Number},3:{name:"offset_end_index",R:5,type:Number},4:{name:"suggestions",Dc:!0,R:9,type:String}}));return SRb};rY.ctor=rY;rY.ctor.U=rY.prototype.U;function TRb(a,b){this.j=a;this.k=b}TRb.prototype.equals=function(a){return this.j.equals(a.Wt())&&this.k.equals(a.getSelection())};TRb.prototype.Wt=g("j");TRb.prototype.getSelection=g("k");function URb(a,b){this.k=a;this.j=b}URb.prototype.getOriginalWord=g("k");URb.prototype.equals=function(a){var b=a.getOriginalWord();a=a.j;return this.k==b&&Mb(this.j,a)};function VRb(a,b,c){this.Lb=a;this.hc=b;this.ae=c}VRb.prototype.equals=function(a){if(this===a)a=!0;else if(a instanceof VRb){var b;if(b=$e(a.Lb,this.Lb)&&a.hc==this.hc)a=a.ae,b=this.ae,b=a==b?!0:a&&b?a.start==b.start&&a.end==b.end:!1;a=b}else a=!1;return a};function sY(a,b,c,d,e){this.q=a;this.Wa=b;this.Oa=c;this.Ra=d;this.ba=e;this.k=this.B=this.j=null;this.D=!1;this.C=[];this.M=[];this.G=new R(this);L(this,this.G);this.J=null;this.K="RANGE";this.Z=new Sn;this.Z.Ux=!0;this.P=new Sn;this.P.Ux=!1}B(sY,K);sY.prototype.V=g("j");
function ARb(a,b,c){$v(a.J);a.G.Hb();a.K=b;a.o=c;a.D=!1;a.C=[];a.M=[];switch(b){case "WORKBOOK":a.B=new F(-1,0);(b=a.q.kX(-1,0,!1,!0))?a.k=""+b.bb():(a.k=null,a.D=!0);break;case "SHEET":a.B=new F(-1,0);a.k=""+c.hc;break;case "RANGE":a.B=new F(c.rect.left-1,c.rect.top),a.k=""+c.hc}}
function WRb(a,b){var c=b.getSelection(),d=lu(a.q,c.hc),e;(e=!d)||(d=d.Gb(),e=c.Lb,e=!(Su(tl(d,"r"),e.y)&&Su(tl(d,"c"),e.x)));if(e)return!1;c=c.ae;d=XRb(a,b);e=b.Wt().getOriginalWord();return d.substring(c.start,c.end)==e}function XRb(a,b){var c=YRb(a,b);return Ea(c,"'")?c.substring(1):c}function ZRb(a,b){var c=YRb(a,b);return Ea(c,"'")}function YRb(a,b){var c=b.getSelection(),d=c.Lb,e=c.hc,f=lu(a.q,e).Gb(),c=mf(c.Lb);f.Qs(c);return f.ad(d.y,d.x).getRawValue(e,d.y,d.x)}
function $Rb(a,b){if(a.k){var c=new nY,d=new ki;J(d,1,a.k);J(d,2,a.B.y);switch(a.K){case "WORKBOOK":J(c,3,!0);mi(d,0);for(var e=p3a(a.q),f=0;f<e.length;f++)if(0==e[f].getSheetType()){var h=e[f];aSb(c,h)}break;case "SHEET":mi(d,0);h=lu(a.q,a.o.hc);aSb(c,h);break;case "RANGE":mi(d,a.o.rect.kb()),li(d,a.o.rect.Ib()),ni(d,a.o.rect.Pb()),h=lu(a.q,a.o.hc),aSb(c,h)}J(c,2,d);J(c,1,a.B.x+1);Bo(Eo(Co(Ao(a.Wa.we("/spell"),{data:a.Z.Vb(c)})),function(a){this.Eh(a,b)},a),function(){this.Eh(null,b)},a).Ed()}else bSb(a,
b,!1)}function aSb(a,b){if(b){var c=Cv(b.Gb());if(Du(c)){var d=""+b.bb(),c=c.getActiveFilterId(),e=new oY;J(e,1,d);J(e,2,c);If(a,4,e)}}}
sY.prototype.Eh=function(a,b){if(a){var c=this.P.jd(pY.U(),a.Te());this.B=new F(H(c,2),H(c,1));this.k=H(c,3);this.D=H(c,6);for(var c=Lf(c,5),d=0;d<c.length;d++)for(var e=c[d],f=e.MO().Xt(),h=e.MO().Hf(),f=new F(h,f),h=parseInt(e.MO().bb(),10),e=Lf(e,1),l=0;l<e.length;l++){var m=e[l],n=m.getOriginalWord(),p=H(m,2),r=H(m,3),p=new VRb(f,h,new bf(p,r));cSb(this,n,p)||(m=Lf(m,4),this.C.push(new TRb(new URb(n,m),p)))}}BRb(this,b,!1)};
function BRb(a,b,c){var d,e;c?(d=a.M,e=A(d.pop,d)):(d=a.C,e=A(d.shift,d));for(;0<d.length;){var f=e(),h=f.Wt().getOriginalWord();if(!cSb(a,h,f.getSelection())){e=c;h=f.getSelection();c=lu(a.q,h.hc);d=c.Gb();h=mf(h.Lb);f=A(a.Ea,a,f,b,e);d.Qs(h)?f():Ie?($v(a.J),a.J=Rp(c.Nf,h).addCallback(f)):(a.G.Hb(),Tp(c.Nf,h,f,a.G));return}}bSb(a,b,c)}function bSb(a,b,c){a.D||c?(a.j=null,b(null)):$Rb(a,b)}sY.prototype.Ea=function(a,b,c){WRb(this,a)?(this.j=a,b(a.Wt())):BRb(this,b,c)};
function cSb(a,b,c){return a.Ra.j.contains(b.toLowerCase())||zRb(a.ba,b,c)||a.Oa.j.contains(b.toLowerCase())}sY.prototype.L=function(){sY.H.L.call(this);$v(this.J)};function dSb(a,b,c,d){this.k=a;this.o=b;this.j=c;this.q=d}
function yRb(a,b){var c=b.k.j;if(WRb(a.j,c)){var d=c.getSelection(),e=d.hc,f=d.ae,h=lu(a.k,e).Gb(),l=ZRb(a.j,c),c=XRb(a.j,c),f=(l?"'":"")+c.substring(0,f.start)+b.j+c.substring(f.end),m=new lF(h,mf(d.Lb),f);Zqa(m,A(function(a){if(a){a=this.j;for(var c=b.j,e=0;e<a.C.length;e++){var f=a.C[e].getSelection();if($e(f.Lb,d.Lb)&&f.hc==d.hc&&f.ae.start>d.ae.end){var h=d.ae,h=h.end-h.start-c.length;f.ae.start-=h;f.ae.end-=h}}}},a));e=new Wn(e,"",mf(d.Lb));VV(a.k,e,A(function(){this.o.Mb(m)},a))}}
function DRb(a,b){if(b){var c=new Wn(b.hc,"",mf(b.Lb));VV(a.k,c)}};function eSb(a){this.Ym=new dMb(a)}eSb.prototype.j=function(a){var b=new xj,c=new ki;J(c,2,a.Lb.y);li(c,a.Lb.y+1);mi(c,a.Lb.x);ni(c,a.Lb.x+1);J(c,1,""+a.hc);If(b,2,c);c=new Nh;J(c,1,""+a.hc);c.Fs(a.Lb.y);J(c,3,a.Lb.x);J(b,1,c);return this.Ym.j(new LO(b))};function fSb(a,b,c,d,e,f,h){uW.call(this,"docs-spellcheckslidingdialog-id",c,A(this.xga,this));this.P=a;this.ba=new MRb(gY.getInstance(),Oo.getInstance());this.M=new wRb;this.K=new NRb(a);this.B=new sY(a,e,gY.getInstance(),this.M,this.K);this.Ea=new dSb(a,b,this.B,this.K);this.G=new mY((new hRb).Da(),this.B,new eSb(a),new iRb("trigger-text",!1));this.k=new xRb(this.G,A(this.fTa,this),c,this.M,this.B,this.Ea,d,this.ba);a=Kg();this.o=a.X("div",{style:"margin-top: 10px"});this.C=My("Search the rest of the sheet",
a);this.C.render(this.o);this.q.F(this.C,"action",this.lhb);this.D=My("Search all sheets",a);this.D.render(this.o);this.q.F(this.D,"action",A(this.xga,this,"WORKBOOK"));DL(h,gY.getInstance(),"docs-user_dictionary");T.f3.subscribe("action",this.k.BYa,this.k);T.g3.subscribe("action",this.k.e1a,this.k);T.L3.subscribe("action",this.k.M4a,this.k);T.rT.subscribe("action",this.k.qRa,this.k);T.k2.subscribe("action",this.k.uXa,this.k);T.h4.subscribe("action",A(this.k.Ota,this.k,!1));T.i4.subscribe("action",
A(this.k.Ota,this.k,!0));T.eC.setVisible(!0);T.eC.subscribe("action",uRb(f,Ac(this.G)))}B(fSb,uW);t=fSb.prototype;t.iX=g("G");t.Dx=function(){fSb.H.Dx.call(this);this.q.F(this.j,"close",this.Jpb).F(this.P,"sheet-view-obscured",this.Kpb)};t.Jpb=function(){this.rD()};t.Kpb=function(){this.j.qp();this.rD()};
t.xga=function(a,b){var c=a,d=b||null,e;if(!c){var f=this.P.$c;f?0==f.getSheetType()?(d=dv(f.Gb()),1<Af(d)?(c="RANGE",d=new Wn(f.bb(),f.k,d)):(c="SHEET",d=new Wn(f.bb(),f.k,null))):c="WORKBOOK":c="WORKBOOK"}"WORKBOOK"!=c&&(e=15E3);switch(c){case "RANGE":this.C.setVisible(!0);this.D.setVisible(!0);Q(this.o,!0);break;case "SHEET":this.C.setVisible(!1);this.D.setVisible(!0);Q(this.o,!0);break;case "WORKBOOK":Q(this.o,!1)}ARb(this.B,c,d);c=this.k;c.K=this.o;c.C=e;T.g4.od(!0);c.j.Yb()||c.j.render(c.D());
(e=c.j.dD)&&c.k.j?c.j.focus():(e||c.O.F(c.j,"close",c.Msa),lY(c,null,!1))};t.fTa=function(){return Kg().getElement(this.Iga())};t.lhb=function(){var a=this.B.o;this.xga("SHEET",new Wn(a.hc,a.Zf,null))};function gSb(){K.call(this)}B(gSb,pn);gSb.prototype.j=function(a,b,c,d,e,f,h){return new fSb(a,b,c,d,e,f,h)};xn("spellcheck",gSb);
